---
title: "HW2"
author: "Cohort 2, Group 7 - Hyeuk Jung, Jiaqi Li, Xichen Luo, Huanyu Liu"
date: "1/26/2019"
output: pdf_document
---

# Problem 1

(a)
```{r, eval=TRUE}
r = vector()
r[1] = 0
r[2] = 1
phi0 = 2
phi1 = 1.1
phi2 = -0.25
sigma = 1
for (i in c(2:1000)){
  r[i+1] = phi0 + phi1 * r[i] + phi2 * r[i-1] + rnorm(1,0,sigma)
}
acf(r, xlim = c(0,20)) 
```
  

(b)
$$\begin{aligned}
1 - \phi_1 x - \phi_2 x^2 &= 0\\
1 - 1.1x + 0.25x^2 &= 0\\
x_1 = \frac{1.1 + \sqrt{1.1^2 - 4 \times 0.25 \times 1}}{2 \times 0.25} &\approx 3.12\\
\omega_1 = x_1^{-1} = 3.12^{-1} = 0.3209\\
x_2 = \frac{1.1 - \sqrt{1.1^2 - 4 \times 0.25 \times 1}}{2 \times 0.25} &\approx 1.28\\
\omega_2 = x_2^{-1} = 0.7791\\
\end{aligned}$$  
Both of the two different characteristic roots modulus of the above polynomial are less than 1, so this AR(2) process is stationary.    
(c)

$$\begin{aligned}
\mu &= \phi_0 = 2\\
\text{Let }X_t &= r_t - \mu\\
X_{t} &= \phi_1 X_{t-1} + \phi_2 X_{t-2} + \epsilon_t\\
\end{aligned}$$


$$\begin{aligned}
\mu &= \phi_0 = 2\\
\text{Let }X_t &= r_t - \mu\\
X_{t} &= \phi_1 X_{t-1} + \phi_2 X_{t-2} + \epsilon_t\\
X_{t+6} &= \phi_1 X_{t+5} + \phi_2 X_{t+4} + \epsilon_{t+6}\\
&= \phi_1 (\phi_1 X_{t+4} + \phi_2 X_{t+3} + \epsilon_{t+5}) + \\ 
   &\phi_2 (\phi_1 X_{t+3} + \phi_2 X_{t+2} + \epsilon_{t+4}) + \epsilon_{t+6}\\
& = \phi_1^2 X_{t+4} + 2\phi_1 \phi_2 X_{t+3} + \phi_2^2 X_{t+2} +\\
&\phi_1 \epsilon_{t+5} + \phi_2 \epsilon_{t+4} + \epsilon_{t+6}\\
& \dots\\
&= \dots + (\phi_2^3 + 6\phi_1^2 \phi_2^2 + 5\phi_1^4\phi_2^1 + \phi_1^6)\epsilon_t\\
&\therefore \frac{\partial[r_{t+6}-\mu]}{\partial \epsilon_t} = \phi_2^3 + 6\phi_1^2 \phi_2^2 + 5\phi_1^4\phi_2^1 + \phi_1^6\\
& \approx 0.37956\\
\end{aligned}$$  

(d)

$$\begin{aligned}
1 - 0.9x - 0.8x^2 &= 0\\
x_1 = \frac{0.9 + \sqrt{0.9^2 + 4 \times 0.8 \times 1}}{2 \times -0.8} &\approx -1.814\\
\omega_1 = x_1^{-1} = (-1.8141)^{-1} &= -0.5512\\
x_2 = \frac{0.9 - \sqrt{0.9^2 + 4 \times 0.8 \times 1}}{2 \times -0.8} &\approx 0.689\\
\omega_2 = x_2^{-1} &= 1.4512\\
\end{aligned}$$  
The modulus of one of the two different characteristic roots of the above polynomial is larger than 1, so this AR(2) process is not stationary.  
For the dynamic multiplier, the calculation is similar as in (c).  
$$\begin{aligned}
\frac{\partial[r_{t+6}-\mu]}{\partial \epsilon_t} &= \phi_2^3 + 6\phi_1^2 \phi_2^2 + 5\phi_1^4\phi_2^1 + \phi_1^6\\
& \approx 6.77824\\
\end{aligned}$$



# Problem 2

```{r, eval=TRUE}
library("MTS")
library(readxl)
df = read_xls("PPIFGS.xls")
plot(x = df$DATE, df$VALUE, type = 'l')
plot(diff(df$VALUE),x=df$DATE[-1],type = 'l')
plot(x = df$DATE, log(df$VALUE),type = 'l')
plot(diff(log(df$VALUE)),x=df$DATE[-1],type = 'l')
```

(b) $\Delta logPPI$ looks covariance-stationary. 

```{r,eval=TRUE}
y = diff(log(df$VALUE))
acf(y,lag.max = 12)
```

(c)
```{r, eval=TRUE}
pacf(y,lag.max = 12)
```

